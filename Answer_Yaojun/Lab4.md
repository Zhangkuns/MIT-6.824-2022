# 实验4：分片键/值服务（WIP）
## 介绍
- 在这个实验中，您将构建一个键/值存储系统，该系统对键进行“分片”或分区，将键的分区划分为一组副本。一个分片是键/值对的一个子集；例如，以"a"开头的所有键可能是一个分片，以"b"开头的所有键可能是另一个分片，依此类推。分片的原因是为了提高性能。每个副本组仅处理一些分片的puts和gets，并且这些组并行运行；因此，总体系统吞吐量（单位时间内的puts和gets）与组数成正比增加。

- 您的分片键/值存储将有两个主要组件。首先，一组副本组。每个副本组负责一些分片。一个副本由使用Raft来复制组的分片的几个服务器组成。第二个组件是“分片控制器”。分片控制器决定每个分片应由哪个副本组提供；这些信息称为配置。配置会随时间变化。客户端咨询分片控制器以查找键的副本组，而副本组咨询控制器以查找要提供的分片。整个系统有一个单独的分片控制器，以Raft实现为容错服务。

- 一个分片存储系统必须能够在副本组之间转移分片。一个原因是有些组可能比其他组更负载，因此需要移动分片以平衡负载。另一个原因是副本组可能加入和离开系统：可能会添加新的副本组以增加容量，或者现有的副本组可能被下线进行维护或退役。

- 这个实验的主要挑战将是处理重新配置——分配给组的分片的变化。在单个副本组中，所有组成员必须就何时发生重新配置达成一致，相对于客户端Put/Append/Get请求。例如，Put可能在重新配置的同时到达，导致副本组不再负责包含Put键的分片。组中的所有副本必须就Put是在重新配置之前还是之后发生达成一致。如果在之前，Put应该生效，分片的新所有者将看到其效果；如果在之后，Put将不会生效，客户端必须在新的所有者处重新尝试。推荐的方法是让每个副本组使用Raft不仅记录Put、Append和Get的序列，还记录重新配置的序列。您需要确保在任何时候每个分片只由一个副本组提供服务。

- 重新配置还需要在副本组之间进行交互。例如，在配置10中，组G1可能负责分片S1。在配置11中，组G2可能负责分片S1。在从10到11的重新配置期间，G1和G2必须使用RPC将分片S1的内容（键/值对）从G1移动到G2。
## Part A: 分片控制器（简单）

## Part B: 分片键/值服务器（困难）